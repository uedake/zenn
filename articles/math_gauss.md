---
title: "æ­£è¦åˆ†å¸ƒ"
emoji: "ğŸ“˜"
type: "tech"
topics:
  - "math"
published: false
published_at: "2023-09-03 22:13"
---

# è§£èª¬å¯¾è±¡

æœ¬è¨˜äº‹ã§ã¯ã€å¤šå¤‰é‡æ­£è¦åˆ†å¸ƒã®å‘¨è¾ºåˆ†å¸ƒã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚å¤šå¤‰é‡æ­£è¦åˆ†å¸ƒã®å‘¨è¾ºåˆ†å¸ƒã¯ã€å¤šå¤‰é‡æ­£è¦åˆ†å¸ƒãŒå®šç¾©ã•ã‚ŒãŸç©ºé–“ä¸Šã§æ­£å°„å½±ã—ãŸã¨ãã«ç¾ã‚Œã‚‹åˆ†å¸ƒã§ã™ã€‚

## å®šç¾©

ä¸­å¿ƒãŒ$\bm{Î¼} \in \R^n$ã§åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ãŒ$Î£ \in M_{n,n}$ã§ã‚ã‚‹$n$æ¬¡å…ƒã®å¤šå¤‰é‡æ­£è¦åˆ†å¸ƒ$G_n:\R^n \rightarrow \R$ã‚’ã€næ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«$\bm{v} \in \R^n$ã«å¯¾ã—ã¦ä¸‹è¨˜ã§å®šç¾©ã™ã‚‹ã€‚

$$
G_n(\bm{v};\bm{Î¼},Î£) =
\frac{1}{\sqrt{(2\pi)^n|Î£|}}
\Large
e^{-\frac{(\bm{v}-Î¼)^{T}Î£^{-1}(\bm{v}-Î¼)}{2}}
\tag{1}
$$

## åˆ¥å®šç¾©

åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ãŒ$Î£$ã®é€†è¡Œåˆ—ã‚’$Î›=Î£^{-1}$ã¨æ›¸ãç²¾åº¦è¡Œåˆ—ã¨å‘¼ã¶ã€‚ç²¾åº¦è¡Œåˆ—ã§æ­£è¦åˆ†å¸ƒã‚’è¨˜è¼‰ã—ãŸå ´åˆã¯ä¸‹è¨˜ã¨ãªã‚‹ã€‚

$$
G_n(\bm{v};\bm{Î¼},Î›) =
\sqrt{\frac{|Î›|}{(2\pi)^n}}
\Large
e^{-\frac{(\bm{v}-Î¼)^{T}Î›(\bm{v}-Î¼)}{2}}
\tag{2}
$$

## éƒ¨åˆ†è¡Œåˆ—

å¾Œè¿°ã®æ­£è¦åˆ†å¸ƒã®å‘¨è¾ºåˆ†å¸ƒã®è¨ˆç®—ï¼ˆç©åˆ†ï¼‰ã®ç‚ºã«$Î£$ã¨$Î›$ã®éƒ¨åˆ†è¡Œåˆ—ã‚’å®šç¾©ã—ã¦ãŠãã€‚

åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—$Î£$ã‚’æœ€çµ‚åˆ—ãƒ»æœ€çµ‚è¡Œéƒ¨åˆ†ã¨ãã‚Œä»¥å¤–ã«åˆ†ã‘ã‚‹ã€‚$Î£_{n-1} \in M_{n-1,n-1}$ã€$\bm{s}_{n-1} \in \R^{n-1}$ã€$Ïƒ_{n}^{2} \in \R$ã§è¨˜è¿°ã™ã‚‹ã¨ä¸‹è¨˜ã¨ãªã‚‹

$$
Î£= \begin{bmatrix}
   Î£_{n-1} & \bm{s}_{n-1} \\
   \bm{s}_{n-1}^{T} & Ïƒ_{n}^{2}
   \end{bmatrix}
\tag{3}
$$

åŒæ§˜ã«ç²¾åº¦è¡Œåˆ—$Î›$ã‚’æœ€çµ‚åˆ—ãƒ»æœ€çµ‚è¡Œéƒ¨åˆ†ã¨ãã‚Œä»¥å¤–ã«åˆ†ã‘ã‚‹ã€‚$Î›_{n-1} \in M_{n-1,n-1}$ã€$\bm{a}_{n-1} \in \R^{n-1}$ã€$Î±_{n,n} \in \R$ã§è¨˜è¿°ã™ã‚‹ã¨ä¸‹è¨˜ã¨ãªã‚‹

$$
Î›= \begin{bmatrix}
   Î›_{n-1} & \bm{a}_{n-1} \\
   \bm{a}_{n-1}^{T} & Î±_{n,n}
   \end{bmatrix}
\tag{4}
$$

ä¸Šè¨˜ã®å®šç¾©ã«ãŠã„ã¦ã¯$Î£Î›=E_n$(â€»$E_n$ã¯ãƒ©ãƒ³ã‚¯$n$ã®å˜ä½è¡Œåˆ—)ã®é–¢ä¿‚ã‚ˆã‚Šä¸‹è¨˜ãŒæˆã‚Šç«‹ã¤

$$
Î£_{n-1}Î›_{n-1}+\bm{s}_{n-1}\bm{a}_{n-1}^{T}=E_{n-1}
$$
$$
Î£_{n-1}\bm{a}_{n-1}+\bm{s}_{n-1}Î±_{n,n}=\bm{0}
$$
$$
Î›_{n-1}\bm{s}_{n-1}+\bm{a}_{n-1}Ïƒ^2_{n}=\bm{0}
$$
$$
\bm{s}_{n-1}^{T}\bm{a}_{n-1}+Ïƒ^2_{n}Î±_{n,n}=1
$$

ã¾ãŸä¸Šè¨˜ã®å¼ã‚’æ•´ç†ã™ã‚‹ã¨ä¸‹è¨˜ãŒæ±‚ã¾ã‚‹ã€‚

$$
Î£_{n-1}^{-1}=Î›_{n-1}-\frac{\bm{a}_{n-1}\bm{a}_{n-1}^{T}}{Î±_{n,n}}
\tag{5}
$$

ã•ã‚‰ã«ä¸‹è¨˜ã®é€†è¡Œåˆ—ã¨ä½™å› å­è¡Œåˆ—ã®é–¢ä¿‚ã‚ˆã‚Šã€$Î£$ã®ä½™å› å­è¡Œåˆ—ã‚’$\hat{Î£}$ã¨ã™ã‚‹ã¨

$$
Î›ã€€= \frac{1}{|Î£|}\hat{Î£}
$$

ä¸Šå¼ã«ãŠã‘ã‚‹æœ€çµ‚åˆ—ãƒ»æœ€çµ‚è¡Œã®è¦ç´ ã‚’ã¿ã‚‹ã¨ä¸‹è¨˜ãŒæˆã‚Šç«‹ã¤

$$
Î±_{n,n} = \frac{|Î£_{n-1}|}{|Î£|}
\tag{6}
$$

## å¤šå¤‰é‡æ­£è¦åˆ†å¸ƒã®å‘¨è¾ºåˆ†å¸ƒ

$n$æ¬¡å…ƒ(n>=2)ã®å¤šå¤‰é‡æ­£è¦åˆ†å¸ƒ$G_n$ã‚’ã‚ã‚‹ï¼‘ã¤ã®æ¬¡å…ƒã§ç©åˆ†ã—ãŸå‘¨è¾ºåˆ†å¸ƒã¯ã€$n-1$æ¬¡å…ƒã®å¤šå¤‰é‡æ­£è¦åˆ†å¸ƒ$G_{n-1}$ã¨ãªã‚‹ã€‚ç‰¹ã«æœ€çµ‚æ¬¡å…ƒã§ç©åˆ†ã—ãŸå ´åˆã‚’è€ƒãˆæœ€çµ‚æ¬¡å…ƒã‚’åˆ†ã‘ã¦

$$
\bm{v}
= \begin{bmatrix}
  \bm{v}_{n-1} \\
  v_n
  \end{bmatrix}
$$

$$
\bm{Î¼}
= \begin{bmatrix}
  \bm{Î¼}_{n-1} \\
  Î¼_n
  \end{bmatrix}
$$

ã¨è¨˜è¼‰ã™ã‚Œã°ã€ä¸‹è¨˜ãŒæˆã‚Šç«‹ã¤ã€‚

$$
G_{n-1}(\bm{v}_{n-1};\bm{Î¼}_{n-1},Î£_{n-1}) =
\int_{-\infty}^{\infty} G_{n}(\bm{v};\bm{Î¼},Î£)dv_n
\tag{7}
$$

### è¨¼æ˜

å®šç¾©(1)å¼ã‚ˆã‚Š

$$
\int_{-\infty}^{\infty} G_{n}(\bm{v})dv_n
= \frac{1}{\sqrt{(2\pi)^n|Î£|}}
 \int_{-\infty}^{\infty}
\Large
e^{-\frac{(\bm{v}-Î¼)^{T}Î£^{-1}(\bm{v}-Î¼)}{2}}
\normalsize
dv_n
$$

$\bm{v}=\bm{v}'+\bm{Î¼}$ã¨ç½®ãã¨ã€

$$
\bm{v}'
= \begin{bmatrix}
  \bm{v}_{n-1}' \\
  v_n'
  \end{bmatrix}
= \begin{bmatrix}
  \bm{v}_{n-1} - \bm{Î¼}_{n-1}\\
  v_n - Î¼_n
  \end{bmatrix}
$$

$$
\int_{-\infty}^{\infty} G_{n}(\bm{v})dv_n
= \frac{1}{\sqrt{(2\pi)^n|Î£|}}
 \int_{-\infty}^{\infty}
\Large
e^{-\frac{\bm{v}'^{T}Î£^{-1}\bm{v}'}{2}}
\normalsize
dv'_n
\tag{8}
$$

ã“ã“ã§æŒ‡æ•°é–¢æ•°ã®è‚©ã®éƒ¨åˆ†ã®ï¼’æ¬¡å½¢å¼éƒ¨åˆ†ã‚’æŠœãå‡ºã—ã¦$F$ã¨æ›¸ãã¨ã€

$$
F = \bm{v}'^{T}Î£^{-1}\bm{v}'= \bm{v}'^{T}Î›\bm{v}'
$$

ä¸Šå¼ã‚’éƒ¨åˆ†è¡Œåˆ—ã‚’ç”¨ã„ã¦ç©å’Œã«åˆ†è§£ã—ã€$v_n'$ã«ã¤ã„ã¦å¹³æ–¹å®Œæˆã—ã€(5)å¼ã‚’é©ç”¨ã™ã‚‹ã¨

$$
\begin{split}
F 
& = \bm{v}_{n-1}'^{T}Î›_{n-1}\bm{v}_{n-1}'
  + 2\bm{v}_{n-1}'^{T}\bm{a}_{n-1}v_n'
  + Î±_{n,n}v_n'^2 \\
& = Î±_{n,n}(v_n'+\frac{\bm{v}_{n-1}'^{T}\bm{a}_{n-1}}{Î±_{n,n}})^2
  + \bm{v}_{n-1}'^{T}Î›_{n-1}\bm{v}_{n-1}'
  - \frac{(\bm{v}_{n-1}'^{T}\bm{a}_{n-1})^2}{Î±_{n,n}} \\
& = Î±_{n,n}(v_n'+\frac{\bm{v}_{n-1}'^{T}\bm{a}_{n-1}}{Î±_{n,n}})^2
  + \bm{v}_{n-1}'^{T}(Î›_{n-1}-\frac{\bm{a}_{n-1}\bm{a}_{n-1}^{T}}{Î±_{n,n}})\bm{v}_{n-1}' \\
& = Î±_{n,n}(v_n'+\frac{\bm{v}_{n-1}'^{T}\bm{a}_{n-1}}{Î±_{n,n}})^2
  + \bm{v}_{n-1}'^{T}Î£_{n-1}^{-1}\bm{v}_{n-1}'
\end{split} 
$$

ã“ã“ã§å…¬å¼

$$
\int_{-\infty}^{\infty} e^{-ax^2}dx=\sqrt{\frac{\pi}{a}}
$$

ã‚’ç”¨ã„ã‚‹ã¨ã€Fã®ç¬¬ï¼‘é …ã®ç©åˆ†ã¯

$$
\int_{-\infty}^{\infty}
\Large
e^{-\frac{Î±_{n,n}(v_n'+\frac{\bm{v}_{n-1}'^{T}\bm{a}_{n-1}}{Î±_{n,n}})^2}{2}}
\normalsize
dv_n'
= \sqrt{\frac{2\pi}{Î±_{n,n}}}
$$

ã§ã‚ã‚‹ã‹ã‚‰ã€(8)å¼ã¯ç©åˆ†éƒ¨åˆ†ãŒè¨ˆç®—ã§ãã€ã•ã‚‰ã«(6)å¼ã‚’é©ç”¨ã—ã€æœ€å¾Œã«$\bm{v}_{n-1}'$ã‚’$\bm{v}_{n-1}$ã«æˆ»ã™ã¨

$$
\begin{split}
\int_{-\infty}^{\infty} G_{n}(\bm{v})dv_n
= & \frac{1}{\sqrt{(2\pi)^n|Î£|}}
\sqrt{\frac{2\pi}{Î±_{n,n}}}
\Large
e^{-\frac{\bm{v}_{n-1}'^{T}Î£_{n-1}^{-1}\bm{v}_{n-1}'}{2}} \\
= & \frac{1}{\sqrt{(2\pi)^{n-1}|Î£_{n-1}|}}
\Large
e^{-\frac{\bm{v}_{n-1}'^{T}Î£_{n-1}^{-1}\bm{v}_{n-1}'}{2}} \\
= & \frac{1}{\sqrt{(2\pi)^{n-1}|Î£_{n-1}|}}
\Large
e^{-\frac{(\bm{v}_{n-1}-\bm{Î¼}_{n-1})^{T}Î£_{n-1}^{-1}(\bm{v}_{n-1}-\bm{Î¼}_{n-1})}{2}} \\
= & G_{n-1}(\bm{v}_{n-1};\bm{Î¼}_{n-1},Î£_{n-1})
\end{split}
$$

ã¨ãªã‚Š(7)å¼ãŒè¨¼æ˜ã§ããŸã€‚