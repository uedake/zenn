---
title: "カメラモデル"
emoji: "📘"
type: "tech"
topics:
  - "camera"
published: false
---

# 解説対象

本記事では、カメラ画像を扱上での前提知識として必要なカメラモデルを解説します。

## ピンホールカメラモデル

歪みやボケのない理想的なカメラは、ピンホールカメラモデルと呼ばれカメラを考えるうえでの基礎となる。ピンホールカメラモデルでは、カメラの中心点（光学中心）を通る光線を独立に各画素で記録していると考えるモデルである。これは、3次元上の点を2次元スクリーン上に投影した点を求める変換として射影変換（＝透視投影変換）を用いることと等しい。

## 座標系と点の定義

あるシーンwにおいてピンホールカメラcを用いカメラ設定dで撮影された画像iを考える。この時、カメラで記録されるシーン上の点と画像上の点の関係を記述するにあたり、下記の座標系を定義する

|座標系|座標系が定義される台|定義|
|-|-|-|
|世界座標系$w$|実空間$\R^3$|シーン上に任意の位置姿勢に設定する直交座標系（右手系とする）|
|カメラ座標系$c$|実空間$\R^3$|カメラ毎に定義される座標系であり、カメラの光学中心の位置を原点とし、光軸方向をz軸（撮影される物空間側をz正とする）、カメラの下方向をy軸とする座標系|
|画像座標系$i$|画像$\R^2$|画像毎に定義される座標系であり、画像の左上を原点とし、右方向をx軸下方向をy軸とする座標系|

カメラで記録される点を下記の通り表現する

|点|記述座標系|定義|
|-|-|-|
|物点$\bm{v}$|世界座標系・カメラ座標系|画像に記録された点に対応する実空間上の点|
|投影点$\bm{s}$|カメラ座標系|画像に記録された点を生じさせた光線がカメラ座標系のz=1平面と交わる点|
|像点$\bm{p}$|画像座標系|画像に記録された点を生じさせた光線がカメラ座標系のz=1平面と交わる点|

## 座標系と点の間の関係

### 物点（世界座標系）と物点（カメラ座標系）の関係

シーン中のある物点について、世界座標系での位置$\bm{v}_w \in \R^3）$とカメラ座標系での位置$\bm{v}_c \in \R^3$の関係は、カメラ$c$の外部パラメータ行列$A_c \in M_{3,4}$で決まる。

$$ \bm{v}_c = A_c\begin{bmatrix} \bm{v}_w \\ 1  \end{bmatrix} $$

外部パラメータ行列はカメラの位置姿勢で決まる自由度６の行列である。

### 物点（カメラ座標系）と投影点（カメラ座標系）の関係

シーン中のある物点のカメラ座標系での位置$\bm{v}_c \in \R^3$とその物点がつくる投影点のカメラ座標系での位置$\bm{p}_c \in \R^3$は、透視投影変換$f_p:\R^3 \rightarrow \R^3$で決まる。

$$ \bm{s}_c = \bm{f_p}(\bm{v}_c)=\begin{bmatrix} x_c/z_c \\ y_c/z_c \\ 1  \end{bmatrix}$$ 


### 投影点（カメラ座標系）と像点（画像座標系）の関係

投影点のカメラ座標系での位置$\bm{s}_c \in \R^3$と像点の画像座標系での位置$\bm{p}_i \in \R^2$の対応関係はカメラの内部パラメータ行列$K_d \in M_{3,3}$で決まる。

$$
\begin{bmatrix}\bm{p}_i \\ 1 \end{bmatrix}= K_d \bm{s}_c \\
$$

$$
K_d  = \begin{bmatrix}
    f_x & 0 & p_{x0}\\
    0 & f_y & p_{y0}\\
    0 & 0 & 1
    \end{bmatrix}
$$
$$
K_d^{-1}  = \begin{bmatrix}
    1/f_x & 0 & -p_{x0}/f_x\\
    0 & 1/f_y & -p_{y0}/f_y\\
    0 & 0 & 1
    \end{bmatrix}
$$

上記における$f_x,f_y$はピクセル間距離（画素ピッチ）単位での焦点距離であり、焦点距離$f$、x方向画素ピッチ$PitchX$、y方向画素ピッチ$PitchY$から下記で定まる値である。

$$
f_x = f/PitchX \\
f_y = f/PitchY
$$
